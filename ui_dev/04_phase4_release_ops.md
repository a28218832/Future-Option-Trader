# Phase 4：測試、部署與維運

## 目標

把原型升級為可持續運行的交易分析平台版本。

## 測試策略

### 1) 單元測試

- `payoff` 計算函式：
  - 單腿 Call/Put
  - 多腿策略（Bull Spread、Iron Condor）
- Greeks 函式：
  - 與已知基準值比對
  - 邊界值測試（極小 T、極端 moneyness）

### 2) 整合測試

- 篩選器 -> T 字報表 -> payoff 圖連動
- 空選取、缺值、異常欄位處理

### 3) 回歸測試

- 固定一組樣本日資料，每版比對輸出圖形關鍵點

## 部署建議

- 開發環境：本機 Dash + parquet
- 伺服器：`gunicorn`（Linux）或 `waitress`（Windows）
- 反向代理：Nginx（可選）
- 若多使用者：快取升級 Redis

## 風險控管

- 資料更新失敗時回退至前一版本快照
- Greeks 計算失敗時顯示降級資訊（而非整頁錯誤）
- callback 超時設告警與熔斷（避免連鎖阻塞）

## Roadmap（可延伸）

1. 即時行情接入（WebSocket）
2. 策略模板（常見組合一鍵載入）
3. 情境分析（波動率/時間衰減/跳空壓力測試）
4. 交易紀錄與回測報表整合

## 上線前 Checklist

- 功能正確性（K 線、T 字、Payoff）
- 延遲達標（p95）
- 錯誤追蹤可觀測（log/metrics）
- 文件齊全（操作手冊 + 技術手冊）
